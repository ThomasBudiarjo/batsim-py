

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Scheduling &mdash; Batsim-py 1.0.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Shutdown" href="shutdown.html" />
    <link rel="prev" title="Batsim-py" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Batsim-py
          

          
          </a>

          
            
            
              <div class="version">
                1.0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Scheduling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#1.-Simulation-Inputs">1. Simulation Inputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.1.-Platform-Description">1.1. Platform Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.2.-Workload-Description">1.2. Workload Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#2.-Schedulers-Definition">2. Schedulers Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#2.1.-First-Come-First-Served-(FCFS)">2.1. First Come First Served (FCFS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2.-EASY-Backfilling-(EASY)">2.2. EASY Backfilling (EASY)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#3.-Simulation-Process">3. Simulation Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="#4.-Results-Discussion">4. Results Discussion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Next-Steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shutdown.html">Shutdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="dvfs.html">DVFS</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/simulator.html">Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/events.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/monitors.html">Monitors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/jobs.html">Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_doc/resources.html">Resources</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Batsim-py</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Scheduling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/scheduling.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Scheduling">
<h1>Scheduling<a class="headerlink" href="#Scheduling" title="Permalink to this headline">¶</a></h1>
<p>The objective of the scheduler is to assign jobs to resources. The scheduler policy is what determines the rules that dictate how to conduct this mapping under various objectives: makespan, slowdown, energy consumption, and many others. Batsim allows us to evaluate the scheduler performance under distinct scenarios and workloads. Thus, the objective of this tutorial is to demonstrate how this can be done with batsim-py.</p>
<p>The following tutorial is organized as follows. <a class="reference external" href="#1.-Simulation-Inputs">Section 1</a> presents the simulation input (platform and workload). <a class="reference external" href="#2.-Schedulers-Definition">Section 2</a> details the scheduling policy implementation. <a class="reference external" href="#3.-Simulation-Process">Section 3</a> presents the simulation process. Lastly, <a class="reference external" href="#4.-Results-Discussion">Section 4</a> presents the results and discusses the advantages of each scheduling policy evaluated.</p>
<div class="section" id="1.-Simulation-Inputs">
<h2>1. Simulation Inputs<a class="headerlink" href="#1.-Simulation-Inputs" title="Permalink to this headline">¶</a></h2>
<p>To evaluate the scheduler performance, we must define a platform and a workload. The platform describes resource characteristics (performance, energy consumption, …) and the network. The workload describes job characteristics that will simulate user behavior. Optionally, we can also define some external events to setup when machines become unavailable/available but this isn’t necessary and won’t be discussed here.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>To fully understand the platform description, you are encouraged to read the <a class="reference external" href="https://simgrid.org/doc/latest/XML_Reference.html#platform-reference">Simgrid documentation</a>. Information about the workload description can be found in <a class="reference external" href="https://batsim.readthedocs.io/en/latest/input-workload.html">Batsim documentation</a>.</p>
</div>
<div class="section" id="1.1.-Platform-Description">
<h3>1.1. Platform Description<a class="headerlink" href="#1.1.-Platform-Description" title="Permalink to this headline">¶</a></h3>
<p>For this tutorial, we define a simple platform with 2 computing resources (hosts) without networking and storages. Moreover, as we are not interested in the energy consumption of the hosts, we define just 1 power state for each host. Extra information about the energy model can be found in the <a class="reference internal" href="shutdown.html"><span class="doc">Shutdown tutorial</span></a>.</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&#39;1.0&#39;?&gt;</span>
<span class="cp">&lt;!DOCTYPE platform SYSTEM &quot;http://simgrid.gforge.inria.fr/simgrid/simgrid.dtd&quot;&gt;</span>
<span class="nt">&lt;platform</span> <span class="na">version=</span><span class="s">&quot;4.1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;zone</span> <span class="na">id=</span><span class="s">&quot;AS0&quot;</span> <span class="na">routing=</span><span class="s">&quot;Full&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- This host will be used by Batsim and won&#39;t be accounted. --&gt;</span>
        <span class="nt">&lt;host</span> <span class="na">id=</span><span class="s">&quot;master_host&quot;</span> <span class="na">pstate=</span><span class="s">&quot;0&quot;</span> <span class="na">speed=</span><span class="s">&quot;1000010.0Mf&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_per_state&quot;</span> <span class="na">value=</span><span class="s">&quot;95.0:190.1&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_off&quot;</span> <span class="na">value=</span><span class="s">&quot;9&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/host&gt;</span>

        <span class="c">&lt;!-- These hosts will be used to compute jobs. --&gt;</span>
        <span class="nt">&lt;host</span> <span class="na">id=</span><span class="s">&quot;0&quot;</span> <span class="na">pstate=</span><span class="s">&quot;0&quot;</span> <span class="na">speed=</span><span class="s">&quot;1000010.0f&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_per_state&quot;</span> <span class="na">value=</span><span class="s">&quot;95.0:190.1&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_off&quot;</span> <span class="na">value=</span><span class="s">&quot;9&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/host&gt;</span>
        <span class="nt">&lt;host</span> <span class="na">id=</span><span class="s">&quot;1&quot;</span> <span class="na">pstate=</span><span class="s">&quot;0&quot;</span> <span class="na">speed=</span><span class="s">&quot;1000010.0f&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_per_state&quot;</span> <span class="na">value=</span><span class="s">&quot;95.0:190.1&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;prop</span> <span class="na">id=</span><span class="s">&quot;watt_off&quot;</span> <span class="na">value=</span><span class="s">&quot;9&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/host&gt;</span>
    <span class="nt">&lt;/zone&gt;</span>
<span class="nt">&lt;/platform&gt;</span>
</pre></div>
</div>
<p>To summarize the platform:</p>
<ul class="simple">
<li><p>We define a <strong>“master_host”</strong> (check the <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute) to be used by Batsim. This host won’t be accounted in the simulation results (only Batsim can use this host).</p></li>
<li><p>For each host, we define just 1 power state. This means that we can’t shutdown or boot the hosts.</p></li>
<li><p>The power state (0) defines:</p>
<ul>
<li><p>The host can compute 1000010.0 flops.</p></li>
<li><p>The host consumes 190.1 Watts while it’s executing a job and 95.0 Watts while it’s idle.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="1.2.-Workload-Description">
<h3>1.2. Workload Description<a class="headerlink" href="#1.2.-Workload-Description" title="Permalink to this headline">¶</a></h3>
<p>After describing the platform, we must specify the workload. Let’s define a simple workload of 4 jobs and 2 simple profiles without network usage. If we decide to use the network or to define IO jobs, we must tweak the platform first.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;nb_res&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nt">&quot;jobs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
            <span class="nt">&quot;res&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;subtime&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;walltime&quot;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span>
            <span class="nt">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;120&quot;</span><span class="p">,</span>
            <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="nt">&quot;res&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="nt">&quot;subtime&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="nt">&quot;walltime&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
            <span class="nt">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
            <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span>
            <span class="nt">&quot;res&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;subtime&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="nt">&quot;walltime&quot;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span>
            <span class="nt">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;120&quot;</span><span class="p">,</span>
            <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
            <span class="nt">&quot;res&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">&quot;subtime&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="nt">&quot;walltime&quot;</span><span class="p">:</span> <span class="mi">140</span><span class="p">,</span>
            <span class="nt">&quot;profile&quot;</span><span class="p">:</span> <span class="s2">&quot;80&quot;</span><span class="p">,</span>
            <span class="nt">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">3</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;profiles&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;120&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;cpu&quot;</span><span class="p">:</span> <span class="mi">120000000</span><span class="p">,</span>
            <span class="nt">&quot;com&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;parallel_homogeneous&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;80&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;cpu&quot;</span><span class="p">:</span> <span class="mi">80000000</span><span class="p">,</span>
            <span class="nt">&quot;com&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;parallel_homogeneous&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To summarize the workload:</p>
<ul class="simple">
<li><p>We define 4 jobs to be submitted in different simulation times (1, 5 and 10 seconds).</p></li>
<li><p>We define 2 profiles to specify how many flops (<code class="docutils literal notranslate"><span class="pre">CPU</span></code>) the job will compute on each requested hosts (80 Mf and 120 Mf).</p></li>
</ul>
</div>
</div>
<div class="section" id="2.-Schedulers-Definition">
<h2>2. Schedulers Definition<a class="headerlink" href="#2.-Schedulers-Definition" title="Permalink to this headline">¶</a></h2>
<div class="section" id="2.1.-First-Come-First-Served-(FCFS)">
<h3>2.1. First Come First Served (FCFS)<a class="headerlink" href="#2.1.-First-Come-First-Served-(FCFS)" title="Permalink to this headline">¶</a></h3>
<p>The FCFS policy schedule jobs by the order of their arrival. Thus, we only need to know the job submission times (to give execution priorities) and the current number of available resources. We assume that each host can execute a single job per time (they’re not shareable). Thus, a host is available if it’s not being used by any other job.</p>
<p>Check the code below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">batsim_py.simulator</span> <span class="kn">import</span> <span class="n">SimulatorHandler</span>

<span class="k">class</span> <span class="nc">FCFSScheduler</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulator</span><span class="p">:</span> <span class="n">SimulatorHandler</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span> <span class="o">=</span> <span class="n">simulator</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;FCFS&quot;</span>

    <span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;  First Come First Served policy &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">is_running</span>

        <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">queue</span><span class="p">:</span>
            <span class="n">available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">get_not_allocated_hosts</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">res</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">):</span>
                <span class="c1"># Schedule if the job can start now.</span>
                <span class="n">allocation</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">available</span><span class="p">[:</span><span class="n">job</span><span class="o">.</span><span class="n">res</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">allocation</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise, wait for resources.</span>
                <span class="k">break</span>
</pre></div>
</div>
</div>
<p>The implementation is very simple and the policy rules are implemented in the <strong>schedule method</strong>. If there are available resources for the first job in the queue, we allocate resources to it. Otherwise, we stop scheduling and wait until the required number of resources are released.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>If you want an event-based design, you can subscribe to the job submitted and job completed events to start the scheduling process every time a job is submitted or completed.</p>
</div>
</div>
<div class="section" id="2.2.-EASY-Backfilling-(EASY)">
<h3>2.2. EASY Backfilling (EASY)<a class="headerlink" href="#2.2.-EASY-Backfilling-(EASY)" title="Permalink to this headline">¶</a></h3>
<p>The EASY policy extends the FCFS policy to increase its efficiency. A disadvantage of the FCFS policy is that some resources may remain idle even though there are jobs in the queue that could use it.</p>
<p>To overcome this inefficiency and prevent job starvation, the EASY policy implements a backfilling mechanism to allow short jobs to skip ahead provided they do not delay the job at the head of the queue (called priority job).</p>
<p>Thus, to implement the EASY scheduler we just need to extend the FCFS to include this mechanism:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">EASYScheduler</span><span class="p">(</span><span class="n">FCFSScheduler</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;EASY&quot;</span>

    <span class="k">def</span> <span class="nf">schedule</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">schedule</span><span class="p">()</span> <span class="c1"># Schedule with FCFS</span>

        <span class="c1"># Apply the backfilling mechanism</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">queue</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">backfill</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">backfill</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">queue</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>

        <span class="c1"># The priority job is the first job in the queue.</span>
        <span class="n">p_job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># The remaining jobs can be scheduled if they do not delay p_job.</span>
        <span class="n">backfilling_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">queue</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="c1"># Get the next expected releases</span>
        <span class="n">next_releases</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">agenda</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">release_time</span><span class="p">)</span>

        <span class="c1"># Get the last required host for p_job.</span>
        <span class="n">last_host</span> <span class="o">=</span> <span class="n">next_releases</span><span class="p">[</span><span class="n">p_job</span><span class="o">.</span><span class="n">res</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1"># The last host release time will be the p_job expected start time.</span>
        <span class="n">p_start_t</span> <span class="o">=</span> <span class="n">last_host</span><span class="o">.</span><span class="n">release_time</span>

        <span class="c1"># Find candidates and reserve resources for p_job.</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">next_releases</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">release_time</span> <span class="o">&lt;=</span> <span class="n">p_start_t</span><span class="p">]</span>

        <span class="c1"># Try to maximize the number of hosts available for the remaining queue.</span>
        <span class="n">reservation</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="o">-</span><span class="n">p_job</span><span class="o">.</span><span class="n">res</span><span class="p">:]</span>

        <span class="c1"># Let&#39;s try to start some jobs earlier.</span>
        <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">backfilling_queue</span><span class="p">:</span>
            <span class="n">available</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">get_not_allocated_hosts</span><span class="p">()</span>  <span class="c1"># Hosts</span>
            <span class="n">not_reserved</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">available</span> <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">reservation</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">job</span><span class="o">.</span><span class="n">res</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">not_reserved</span><span class="p">):</span>
                <span class="c1"># Schedule job on not reserved hosts.</span>
                <span class="n">allocation</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">not_reserved</span><span class="p">[:</span><span class="n">job</span><span class="o">.</span><span class="n">res</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">allocation</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">job</span><span class="o">.</span><span class="n">walltime</span> <span class="ow">and</span> <span class="n">job</span><span class="o">.</span><span class="n">walltime</span> <span class="o">&lt;=</span> <span class="n">p_start_t</span> <span class="ow">and</span> <span class="n">job</span><span class="o">.</span><span class="n">res</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">):</span>
                <span class="c1"># Schedule job on reserved hosts without delaying p_job.</span>
                <span class="n">allocation</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">available</span><span class="p">[:</span><span class="n">job</span><span class="o">.</span><span class="n">res</span><span class="p">]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">job</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">allocation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The backfilling mechanism is quite simple. First, we estimate the time when the required number of resources to start the priority job will be available. This estimation is based on the <code class="docutils literal notranslate"><span class="pre">walltime</span></code> property that each job can provide in the workload and is given by the simulator through the <a class="reference internal" href="../api_doc/simulator.html#batsim_py.simulator.SimulatorHandler.agenda"><span class="std std-ref">agenda</span></a> property. Once we know the expected start time of the priority job (<code class="docutils literal notranslate"><span class="pre">p_start_t</span></code>), we can find some candidates (hosts) to be
reserved for it.</p>
<p>For candidates, we select all hosts that will be available before <code class="docutils literal notranslate"><span class="pre">p_start_t</span></code>. Then, we try to reserve the candidates that are close to <code class="docutils literal notranslate"><span class="pre">p_start_t</span></code> in order to maximize the number of available hosts for the backfilling queue. After that, we can start to fill the gaps with the backfilling queue. Only jobs that can start on not reserved hosts or do not delay the execution of the priority job (<code class="docutils literal notranslate"><span class="pre">walltime</span></code> <span class="math notranslate nohighlight">\(&lt;=\)</span> <code class="docutils literal notranslate"><span class="pre">p_start_t</span></code>) will be scheduled.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>If the job <code class="docutils literal notranslate"><span class="pre">walltime</span></code> is unset, the simulator cannot estimate the expected release time. In this case, the job cannot be anticipated by the backfilling mechanism.</p>
</div>
</div>
</div>
<div class="section" id="3.-Simulation-Process">
<h2>3. Simulation Process<a class="headerlink" href="#3.-Simulation-Process" title="Permalink to this headline">¶</a></h2>
<p>After defining the simulation inputs and the schedulers we want to evaluate, it’s time to run the simulation and collect some results.</p>
<p>Check the code below:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">batsim_py</span>

<span class="k">def</span> <span class="nf">run_simulation</span><span class="p">(</span><span class="n">scheduler</span><span class="p">):</span>
    <span class="n">simulator</span> <span class="o">=</span> <span class="n">batsim_py</span><span class="o">.</span><span class="n">SimulatorHandler</span><span class="p">()</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">scheduler</span><span class="p">(</span><span class="n">simulator</span><span class="p">)</span>

    <span class="c1"># 1) Instantiate monitors to collect simulation statistics</span>
    <span class="n">jobs_mon</span> <span class="o">=</span> <span class="n">batsim_py</span><span class="o">.</span><span class="n">monitors</span><span class="o">.</span><span class="n">JobMonitor</span><span class="p">(</span><span class="n">simulator</span><span class="p">)</span>
    <span class="n">sim_mon</span> <span class="o">=</span> <span class="n">batsim_py</span><span class="o">.</span><span class="n">monitors</span><span class="o">.</span><span class="n">SimulationMonitor</span><span class="p">(</span><span class="n">simulator</span><span class="p">)</span>

    <span class="c1"># 2) Start simulation</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">platform</span><span class="o">=</span><span class="s2">&quot;platforms/hosts_2.xml&quot;</span><span class="p">,</span>
                    <span class="n">workload</span><span class="o">=</span><span class="s2">&quot;workloads/comp_4.json&quot;</span><span class="p">,</span>
                    <span class="n">verbosity</span><span class="o">=</span><span class="s2">&quot;information&quot;</span><span class="p">)</span>

    <span class="c1"># 3) Schedule all jobs</span>
    <span class="k">while</span> <span class="n">simulator</span><span class="o">.</span><span class="n">is_running</span><span class="p">:</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="n">schedule</span><span class="p">()</span>
        <span class="n">simulator</span><span class="o">.</span><span class="n">proceed_time</span><span class="p">()</span>  <span class="c1"># proceed directly to the next event.</span>
    <span class="n">simulator</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># 4) Return/Dump statistics</span>
    <span class="k">return</span> <span class="n">jobs_mon</span><span class="p">,</span> <span class="n">sim_mon</span>

<span class="n">jobs_f</span><span class="p">,</span> <span class="n">sim_f</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">FCFSScheduler</span><span class="p">)</span>
<span class="n">jobs_e</span><span class="p">,</span> <span class="n">sim_e</span> <span class="o">=</span> <span class="n">run_simulation</span><span class="p">(</span><span class="n">EASYScheduler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The simulation process involves four steps: - We define some monitors (<strong>#1</strong>) to collect simulation statistics. - Then, we start the simulation process by providing the inputs (<strong>#2</strong>). - The simulation begins and while it’s running we run the scheduling procedure. After the scheduler is done, we proceed the simulation time to the next event. This procedure is repeated until all jobs complete (<strong>#3</strong>). - Lastly, we return the monitors in order to analyze it (<strong>#4</strong>). The monitors can also be
used to dump the results into an external file.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle"><strong>Note</strong></p>
<p>The <a class="reference internal" href="../api_doc/simulator.html#batsim_py.simulator.SimulatorHandler.proceed_time"><span class="std std-ref">proceed_time</span></a> method of the simulator can also be used to proceed the simulation into a specific time. If no value is provided, the simulation will proceed directly to the next dispatched event time. Moreover, it’s worth mentioning that when you define a time <span class="math notranslate nohighlight">\(t\)</span> to proceed the simulation, only the events that happened before <span class="math notranslate nohighlight">\(t\)</span> will be dispatched <span class="math notranslate nohighlight">\(&lt; t\)</span>.</p>
</div>
</div>
<div class="section" id="4.-Results-Discussion">
<h2>4. Results Discussion<a class="headerlink" href="#4.-Results-Discussion" title="Permalink to this headline">¶</a></h2>
<p>The last step in this tutorial is to discuss the results.</p>
<p>We start the discussion by checking the performance of each scheduler policy, check the code below:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Read results</span>
<span class="n">fcfs</span><span class="p">,</span> <span class="n">easy</span> <span class="o">=</span> <span class="n">sim_f</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(),</span> <span class="n">sim_e</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">fcfs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">easy</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;FCFS&quot;</span><span class="p">,</span> <span class="s2">&quot;EASY&quot;</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fcfs</span><span class="p">,</span> <span class="n">easy</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Waiting time</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_waiting_time&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Averaged Waiting Time&quot;</span><span class="p">)</span>

<span class="c1"># Slowdown</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_slowdown&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Averaged Slowdown&quot;</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_scheduling_31_0.png" src="../_images/tutorials_scheduling_31_0.png" />
</div>
</div>
<p>Considering the averaged waiting time and slowdown, the EASY scheduler achieved by far the best performance. By implementing the backfilling mechanism we were able to considerably minimize (on average) both the waiting time and slowdown of the jobs.</p>
<p>To better understand where these gains come from, we can use the <a class="reference external" href="https://pypi.org/project/evalys/">evalys package</a> to plot a Gantt chart:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">evalys.jobset</span> <span class="kn">import</span> <span class="n">JobSet</span>
<span class="kn">from</span> <span class="nn">evalys.visu.legacy</span> <span class="kn">import</span> <span class="n">plot_gantt</span>

<span class="c1"># Convert monitors to dataframes</span>
<span class="n">fcfs</span><span class="p">,</span> <span class="n">easy</span> <span class="o">=</span> <span class="n">jobs_f</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(),</span> <span class="n">jobs_e</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>

<span class="c1"># Load dataframes into JobSet objects.</span>
<span class="n">fcfs</span><span class="p">,</span> <span class="n">easy</span> <span class="o">=</span> <span class="n">JobSet</span><span class="p">(</span><span class="n">fcfs</span><span class="p">),</span> <span class="n">JobSet</span><span class="p">(</span><span class="n">easy</span><span class="p">)</span>

<span class="c1"># Plot gantts</span>
<span class="n">_</span><span class="p">,</span> <span class="n">ax_list</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plot_gantt</span><span class="p">(</span><span class="n">fcfs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;FCFS Scheduler&quot;</span><span class="p">)</span>
<span class="n">plot_gantt</span><span class="p">(</span><span class="n">easy</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;EASY Scheduler&quot;</span><span class="p">)</span>

<span class="c1"># Show</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="c1"># We have two hosts only.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_scheduling_33_0.png" src="../_images/tutorials_scheduling_33_0.png" />
</div>
</div>
<p>Looking at the Gantt chart, we can observe the backfilling mechanism in action. The job <code class="docutils literal notranslate"><span class="pre">w0!4</span></code> was able to start before job <code class="docutils literal notranslate"><span class="pre">w0!2</span></code> without delaying it. Consequently, we achieved better waiting time and slowdown averages.</p>
</div>
<div class="section" id="Next-Steps">
<h2>Next Steps<a class="headerlink" href="#Next-Steps" title="Permalink to this headline">¶</a></h2>
<p>This tutorial is a very simple example of how to evaluate scheduling policies. Neither the platform nor the workload were realistic. Moreover, we didn’t consider the energy model. So, as the next steps, you can extend this tutorial to cover other policies, workloads, and platforms.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shutdown.html" class="btn btn-neutral float-right" title="Shutdown" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Batsim-py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Lucas C. Casagrande

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>